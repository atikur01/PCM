@model PCM.Models.Item

<h2>Edit Item</h2>
<form asp-action="Edit" method="post">
    <input type="hidden" asp-for="Id" />
    <input type="hidden" asp-for="CollectionId" />
    <div class="form-group">
        <label for="Name">Name</label>
        <input asp-for="Name" class="form-control" />
    </div>
    <div class="form-group">
        <label for="Tags">Tags</label>
        <input id="tagsInput" asp-for="Tag1" class="form-control" />
        <input asp-for="Tag2" class="form-control" />
        <input asp-for="Tag3" class="form-control" />
        <input asp-for="Tag4" class="form-control" />
        <input asp-for="Tag5" class="form-control" />
    </div>

    <!-- Add custom fields based on collection -->
    @if (Model.Collection != null)
    {
        if (!string.IsNullOrEmpty(Model.Collection.CustomString1Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomString1Name</label>
                <input asp-for="CustomString1" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomString2Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomString2Name</label>
                <input asp-for="CustomString2" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomString3Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomString3Name</label>
                <input asp-for="CustomString3" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomInt1Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomInt1Name</label>
                <input asp-for="CustomInt1" type="number" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomInt2Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomInt2Name</label>
                <input asp-for="CustomInt2" type="number" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomInt3Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomInt3Name</label>
                <input asp-for="CustomInt3" type="number" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomMultilineText1Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomMultilineText1Name</label>
                <textarea asp-for="CustomMultilineText1" class="form-control"></textarea>
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomMultilineText2Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomMultilineText2Name</label>
                <textarea asp-for="CustomMultilineText2" class="form-control"></textarea>
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomMultilineText3Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomMultilineText3Name</label>
                <textarea asp-for="CustomMultilineText3" class="form-control"></textarea>
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomBoolean1Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomBoolean1Name</label>
                <input name="CustomBoolean1" type="checkbox" class="form-check-input" value="true" @(Model.CustomBoolean1 == true ? "checked" : "") />
                <input type="hidden" name="CustomBoolean1" value="false" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomBoolean2Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomBoolean2Name</label>
                <input name="CustomBoolean2" type="checkbox" class="form-check-input" value="true" @(Model.CustomBoolean2 == true ? "checked" : "") />
                <input type="hidden" name="CustomBoolean2" value="false" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomBoolean3Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomBoolean3Name</label>
                <input name="CustomBoolean3" type="checkbox" class="form-check-input" value="true" @(Model.CustomBoolean3 == true ? "checked" : "") />
                <input type="hidden" name="CustomBoolean3" value="false" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomDate1Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomDate1Name</label>
                <input asp-for="CustomDate1" type="date" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomDate2Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomDate2Name</label>
                <input asp-for="CustomDate2" type="date" class="form-control" />
            </div>
        }
        if (!string.IsNullOrEmpty(Model.Collection.CustomDate3Name))
        {
            <div class="form-group">
                <label>@Model.Collection.CustomDate3Name</label>
                <input asp-for="CustomDate3" type="date" class="form-control" />
            </div>
        }
    }
    <button type="submit" class="btn btn-primary">Save</button>
</form>

<script>
    $(function () {
        $("#tagsInput").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("AutocompleteTags", "Item")',
                    data: { term: request.term },
                    success: function (data) {
                        response(data);
                    }
                });
            },
            minLength: 2
        });
    });
</script>
